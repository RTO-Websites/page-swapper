var PageSwapper=function(l){var m=window,doc=m.document,self=this,defaultArgs={disableCache:false,debug:false,owlConfig:{},owlVersion:2,},owlDefaultArgs={margin:20,mouseDrag:false,touchDrag:false,},container=null,host='http://'+m.location.host,currentUrl=m.location.href,hash='',debug,loadComplete,checkHash,changeUrl,addIdPrefixes,removeIdPrefixes,finish,initFailed=false,init;init=function(){if(!m.$){m.$=jQuery}l=$.extend(defaultArgs,l);l.id='page-swapper';container=$($(l.container)[0]);if(container.is('body')){container.wrapInner('<div class="psw-body"></div>');container=container.find('> .psw-body')}container.wrapInner('<div class="tab psw-starttab psw-tab"></div>');$('body').on('click','a:not(a[href*=".jpg"], a[href*=".jpeg"], a[href*=".png"], a[href*=".gif"], a[href*=".JPG"], a[href*=".GIF"], a[href*=".PNG"], a[href*=".JPEG"])',self.linkClick);$(m).on('popstate',function(){self.open(doc.location.href)});var a=$.extend(owlDefaultArgs,l.owlConfig);a=$.extend(a,{items:1,singleItem:true,autoHeight:true,});container.addClass('psw-container');try{container.owlCarousel(a)}catch(e){initFailed=true;console.info('psw-init-error',e,container,a);return}var b=container.find('.psw-starttab');b.attr('data-url',m.location.href);b.data('title',doc.title);b.data('bodyclass',$('body').prop('class').replace('no-js',''));b.data('originalhtml',b.html());debug('psw init',self,container,l);if(container.data('owl.carousel')&&container.data('owl.carousel')._plugins&&container.data('owl.carousel')._plugins.autoHeight){setInterval(function(){container.data('owl.carousel')._plugins.autoHeight.update()},300)}self.setClasses()};self.linkClick=function(a){if(!a||!a.target||initFailed){return}var b=$(a.target);if(!b.is('a')){b=b.closest('a')}if(!b.prop('href')){return}if(b.hasClass('no-ajax')){return}var c=b.prop('href');if(c.indexOf(host)===-1){return}if(c.indexOf('mailto:')!==-1){return}var d=['zip','exe','rar','pdf','doc','gif','png','jpg','jpeg','bmp','mp4','mp3'],fileEnding=c.split('.');fileEnding=fileEnding[fileEnding.length-1];if($.inArray(fileEnding,d)!==-1){return}a.preventDefault();self.open(c,a)};self.open=function(d,e){var f=d.split('#');hash='';d=f[0];if(typeof(f[1])!=='undefined'){hash=f[1]}container.trigger('psw-beforeopen',{'container':container,'url':d,'hash':hash,'currentUrl':currentUrl,'clickEvent':e,});debug('psw beforeOpen',self,container,l,d,hash,currentUrl);if(currentUrl===d){checkHash();return}var g=container.find('.psw-tab[data-url="'+d+'"]');if(g.length>0){self.openFromCache(g,d);return}$('body').removeClass('psw-finish-loading').addClass('psw-loading');$.ajax({dataType:'text',type:'GET',url:d,data:null,success:function(a,b,c){loadComplete(a,b,d,c)},error:function(){$('body').removeClass('psw-loading');$('body').addClass('psw-loaderror');errorTimeout=setTimeout(function(){$('body').removeClass('psw-loaderror')},1000)}});container.trigger('psw-loadstart',{'container':container,'url':d,'hash':hash,'currentUrl':currentUrl});debug('psw loadstart',self,container,l,d,hash,currentUrl)};loadComplete=function(a,b,c,d){$('body').removeClass('psw-loading').addClass('psw-finish-loading');var f=$('<div class="tab psw-tab" />'),bodyClass='';if(!d){return false}var g=d.getResponseHeader('Content-Type');if(g.indexOf('text/html')===-1){return false}debug('psw loadComplete',self,container,l,c,hash,currentUrl,d);var h=self.getCurrent(),title=a.match(/<title>(.*?)<\/title>/);if(title&&title[1]){title=title[1]}else{title=''}a=a.replace('<body','<body><div id="psw-body"').replace('</body>','</div></body');var i=$.parseHTML(a,true);i=$(i);if(i.filter('#psw-body').length>0){bodyClass=i.filter('#psw-body').prop('class').replace('no-js','');var j=$('body').prop('class');if(l.selector==='body'){bodyClass+=' page-swapper '}$('body').removeClass(j).addClass(bodyClass)}var k=i.find(l.selector);if(k.length===0){k=i.filter('#psw-body')}if(l.owlVersion==1){container.data('owlCarousel').addItem(f);self.setClasses()}else{container.trigger('add.owl.carousel',f);container.trigger('refresh.owl.carousel')}addIdPrefixes(h);f.data('originalhtml',k.html());try{f.html(k.html())}catch(e){k.find('script').remove();f.html(k.html())}changeUrl(c,title);f.attr('data-url',c).data('title',title);f.data('bodyclass',bodyClass);f.parent().addClass('psw-item');self.jumpTo(f.parent().index());finish(f.parent(),{'container':container,'oldTab':h,'newTab':f.parent(),'url':c,'currentUrl':currentUrl})};self.openFromCache=function(a,b){var c=self.getCurrent();addIdPrefixes(c);removeIdPrefixes(a.parent());var d=a.data('originalhtml');a.empty().html(d);changeUrl(b,a.data('title'));debug('psw openFromCache',b,a);var e=a.data('bodyclass');if(l.selector==='body'){e+=' page-swapper '}$('body').removeClass($('body').prop('class')).addClass(e);finish(a.parent(),{'container':container,'oldTab':self.getCurrent(),'newTab':a.parent(),'url':b,})};finish=function(a,b){container.trigger('psw-loadcomplete',b);self.jumpTo(a.index());if(typeof _gaq!=="undefined"&&_gaq!==null){_gaq.push(['_trackPageview',l.url])}if(typeof(ga)!=='undefined'&&ga!==null){ga('send','pageview',location.pathname)}};self.jumpTo=function(a){if(l.owlVersion==1){container.data('owlCarousel').goTo(a)}else{container.trigger('to.owl.carousel',a)}};checkHash=function(){debug('psw checkHash',self,container,l,hash,currentUrl);if(hash&&$('#'+hash).length>0){$('html,body').animate({scrollTop:$('#'+hash).offset().top},600);hash=''}};addIdPrefixes=function(c){c.find('*').each(function(a,b){if(b.id.length>0){b.id='psw-rm-'+b.id}})};removeIdPrefixes=function(c){c.find('*').each(function(a,b){if(b.id.length>0){b.id=b.id.replace('psw-rm-','')}})};self.setClasses=function(){container.addClass('psw-container');container.addClass('owl-carousel');container.find('> .owl-stage-outer, > .owl-wrapper-outer').addClass('psw-stage-outer');container.find('> .owl-stage-outer > .owl-stage, > .owl-wrapper-outer > .owl-wrapper').addClass('psw-stage');container.find('.psw-stage > .owl-item').addClass('psw-item')};self.getCurrent=function(){var a;if(l.owlVersion==1){a=container.find('.psw-item:nth-child('+container.data('owlCarousel').currentItem+')')}else{a=container.find('.psw-item.active')}return a};changeUrl=function(a,b){currentUrl=a;if(m.history&&typeof(m.history.pushState)!=='undefined'){m.history.pushState({},b,a);doc.title=b}};self{c.container=jQuery(b);document.pageSwapperInstance=new PageSwapper(c)}})};.changeCurrentUrl=function(a){currentUrl=a};debug=function(){if(l.debug){console.info(arguments)}};self._debug=function(a){l.debug=a};init()};jQuery.fn.pageSwapper=function(c){if(typeof(c)==='undefined'){c={}}c.selector=this.selector;this.each(function(a,b){if(typeof(document.pageSwapperInstance)==='undefined')