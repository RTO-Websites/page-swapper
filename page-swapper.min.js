var PageSwapper=function(a){var b=window,c=b.document,d=this,e={disableCache:!1,debug:!1,sliderConfig:{},sliderType:"owl"},f=null,g=b.location.protocol+"//"+b.location.host,h=b.location.href,i="",j=!1,k={};pswXhr=null;var l=function(){b.$||(b.$=jQuery),a=$.extend(e,a),a.id="page-swapper",f=$($(a.container)[0]),k={args:a,container:f,instance:d},f.is("body")&&(f.wrapInner('<div class="psw-body"></div>'),f=f.find("> .psw-body")),f.wrapInner('<div class="tab psw-starttab psw-tab"></div>'),$("body").on("click",'a:not(a[href*=".jpg"], a[href*=".jpeg"], a[href*=".png"], a[href*=".gif"], a[href*=".JPG"], a[href*=".GIF"], a[href*=".PNG"], a[href*=".JPEG"])',d.linkClick),$(b).on("popstate",function(){d.open(c.location.href)}),f.addClass("psw-container"),PageSwapper.sliders[a.sliderType].init(k);var g=f.find(".psw-starttab");g.attr("data-url",b.location.href),g.data("title",c.title),g.data("bodyclass",$("body").prop("class").replace("no-js","")),g.data("originalhtml",""),x("psw init",d,f,a),d.setClasses()};d.setArgs=function(b){a=$.extend(a,b)},d.linkClick=function(a){if(a&&a.target&&!j){var b=$(a.target);if(b.is("a")||(b=b.closest("a")),b.prop("href")&&!b.hasClass("no-ajax")){var c=b.prop("href");if(-1!==c.indexOf(g)&&-1===c.indexOf("mailto:")){var e=["zip","exe","rar","pdf","doc","gif","png","jpg","jpeg","bmp","mp4","mp3"],f=c.split(".");f=f[f.length-1],-1===$.inArray(f,e)&&(a.preventDefault(),d.open(c,a))}}}},d.open=function(b,c){var e=b.split("#");if(i="",b=e[0],"undefined"!=typeof e[1]&&(i=e[1]),h===b)return void p();f.trigger("psw-beforeopen",{container:f,url:b,hash:i,currentUrl:h,clickEvent:c}),x("psw beforeOpen",d,f,a,b,i,h);var g=o(b);g||($("body").removeClass("psw-finish-loading").addClass("psw-loading"),pswXhr&&(pswXhr.abort(),pswXhr=null),pswXhr=$.ajax({dataType:"text",type:"GET",url:b,data:{pswLoad:1},success:function(a,c,d){m(a,c,b,d)},error:function(){$("body").removeClass("psw-loading"),$("body").addClass("psw-loaderror"),errorTimeout=setTimeout(function(){$("body").removeClass("psw-loaderror")},1e3)}}),f.trigger("psw-loadstart",{container:f,url:b,hash:i,currentUrl:h,clickEvent:c}),x("psw loadstart",d,f,a,b,i,h))};var m=function(b,c,e,g){$("body").removeClass("psw-loading").addClass("psw-finish-loading");var j,l=$('<div class="tab psw-tab" />'),m=d.getCurrent(),o="",p="";if(!g)return!1;var r=g.getResponseHeader("Content-Type");return-1===r.indexOf("text/html")?!1:(x("psw loadComplete",d,f,a,e,i,h,g),o=w(b),j=t(b),content=j.content,p=j.bodyClass,PageSwapper.sliders[a.sliderType].add(k,l),q(m),l.data("originalhtml",content.html()),v(l,content),s(e,o),l.attr("data-url",e).data("title",o),l.data("bodyclass",p),l.parent().addClass("psw-item"),void n(l.parent(),{container:f,oldTab:m,newTab:l.parent(),url:e,currentUrl:h,fullHtml:j.fullHtml}))};d.openFromCache=function(b,c){var e=d.getCurrent();q(e),r(b.parent());var g=b.data("originalhtml");g&&g.length?b.empty().html(g):u(b),s(c,b.data("title")),x("psw openFromCache",c,b,g);var h=b.data("bodyclass");"body"===a.selector&&(h+=" page-swapper "),$("body").removeClass($("body").prop("class")).addClass(h),n(b.parent(),{container:f,oldTab:d.getCurrent(),newTab:b.parent(),url:c})};var n=function(b,c){if(f.trigger("psw-loadcomplete",c),d.jumpTo(b.index()),x("psw finish",b,b.index()),p(),"undefined"!=typeof _gaq&&null!==_gaq&&_gaq.push(["_trackPageview",a.url]),"undefined"!=typeof ga&&null!==ga&&ga("send","pageview",location.pathname),"undefined"!=typeof Piwik&&null!==Piwik){var e=Piwik.getTracker();e.setCustomUrl(window.location.href),e.setDocumentTitle(document.title),e.trackPageView()}};d.jumpTo=function(b){PageSwapper.sliders[a.sliderType].to(k,b)};var o=function(a){var b=f.find('.psw-tab[data-url="'+a+'"]');return b.length||(b=f.find('.psw-tab[data-url="'+a+'/"]')),b.length>0?(d.openFromCache(b,a),!0):!1},p=function(){x("psw checkHash",d,f,a,i,h),!a.disableHash&&i&&$("#"+i).length>0&&($("html,body").animate({scrollTop:$("#"+i).offset().top},600),i="")},q=function(a){a.find("*").each(function(a,b){b.id.length>0&&(b.id="psw-rm-"+b.id)})},r=function(a){a.find("*").each(function(a,b){b.id.length>0&&(b.id=b.id.replace("psw-rm-",""))})};d.setClasses=function(){f.addClass("psw-container"),PageSwapper.sliders[a.sliderType].setClasses(k)},d.getCurrent=function(){return PageSwapper.sliders[a.sliderType].getCurrent(k)};var s=function(a,d){h=a,b.history&&"undefined"!=typeof b.history.pushState&&(b.history.pushState({},d,a),c.title=jQuery("<textarea />").html(d).text())},t=function(b){b=b.replace("<body",'<body><div id="psw-body"').replace("</body>","</div></body");var c,d=$.parseHTML(b,!0);if(d=$(d),d.filter("#psw-body").length>0){c=d.filter("#psw-body").prop("class").replace("no-js","");var e=$("body").prop("class");"body"===a.selector&&(c+=" page-swapper "),$("body").removeClass(e).addClass(c)}var f=d.find(a.selector);return 0===f.length&&(f=d.filter("#psw-body")),{content:f,bodyClass:c,fullHtml:d}},u=function(a){x("psw getOrgHtml",a,a.data("url")),pswXhr=$.ajax({dataType:"text",type:"GET",url:a.data("url"),data:{pswLoad:1},success:function(b){var c=t(b).content;a.data("originalhtml",c.html()),v(a,c),x("psw getOrgHtml finish",a,c.html())}})},v=function(a,b){try{a.empty().html(b.html())}catch(c){b.find("script").remove(),a.empty().html(b.html())}},w=function(a){var b=a.match(/<title>(.*?)<\/title>/);return b=b&&b[1]?b[1]:""};d.changeCurrentUrl=function(a){h=a};var x=function(){a.debug&&console.info(arguments)};d._debug=function(b){a.debug=b},l()};jQuery.fn.pageSwapper=function(a){"undefined"==typeof a&&(a={}),"undefined"==typeof a.selector&&console.info("PageSwapper: No selector defined"),this.each(function(b,c){"undefined"==typeof document.pageSwapperInstance&&(a.container=jQuery(c),document.pageSwapperInstance=new PageSwapper(a))})},PageSwapper.sliders={},PageSwapper.sliders.owl={owlDefaultArgs:{margin:20,mouseDrag:!1,touchDrag:!1,disableHash:!1},init:function(a){var b=$.extend(PageSwapper.sliders.owl.owlDefaultArgs,a.args.owlConfig,a.args.sliderConfig);b=$.extend(b,{items:1,singleItem:!0,autoHeight:!0});try{a.container.owlCarousel(b)}catch(c){return initFailed=!0,void console.info("psw-owl-init-error",c,a.container,b)}a.container.data("owl.carousel")&&a.container.data("owl.carousel")._plugins&&a.container.data("owl.carousel")._plugins.autoHeight&&setInterval(function(){a.container.data("owl.carousel")._plugins.autoHeight.update()},300),$(document).on("translated.owl.carousel",".psw-container",function(a){a.stopPropagation(),$(a.target).is(".psw-container")&&$(".psw-item:not(.active) .psw-tab").empty()})},to:function(a,b){1==a.args.owlVersion?a.container.data("owlCarousel").goTo(b):a.container.trigger("to.owl.carousel",b)},add:function(a,b){1==a.args.owlVersion?(a.container.data("owlCarousel").addItem(b),a.instance.setClasses()):(a.container.trigger("add.owl.carousel",b),a.container.trigger("refresh.owl.carousel"))},remove:function(a,b){1==a.args.owlVersion?(a.container.data("owlCarousel").removeItem(b.index()),a.instance.setClasses()):(a.container.trigger("remove.owl.carousel",b.index()),a.container.trigger("refresh.owl.carousel"))},setClasses:function(a){a.container.addClass("owl-carousel"),a.container.find("> .owl-stage-outer, > .owl-wrapper-outer").addClass("psw-stage-outer"),a.container.find("> .owl-stage-outer > .owl-stage, > .owl-wrapper-outer > .owl-wrapper").addClass("psw-stage"),a.container.find(".psw-stage > .owl-item").addClass("psw-item")},getCurrent:function(a){var b;return b=a.container.find(1==a.args.owlVersion?".psw-item:nth-child("+container.data("owlCarousel").currentItem+")":".psw-item.active")}};